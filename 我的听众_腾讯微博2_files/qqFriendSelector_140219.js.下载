(function(){MI["r/qqFriendSelector"]=1;MI.QQFriendSelector=function(a){function l(a,b,m){function g(){var h=e.get_count(),a=$$("#btn_follow_and_next span")[0];$("sel_all_txt").innerHTML="已选择"+h+"人";a.innerHTML=h?"收听已选":"请选择好友";return h}var e=this,f=[],j=[];f.push('<ul class="gb_ucard_list clear" style="width:510px;">');for(var d=0,k=b.length;d<k;d++)b[d].account&&(b[d].uin&&b[d].nick)&&(f.push('  <li class="unit" name="'+b[d].account+'" uin="'+b[d].uin+'" cid="'+b[d].quanId+'" cname="'+b[d].reason+'"><div class="gb_ucard">'),f.push('    <div class="gb_ucard_l"> <span class="avatar"><img src="'+(b[d].avatar?b[d].avatar+"/50":"http://mat1.gtimg.com/www/mb/images/head_50.jpg")+'"></span> </div>'),f.push('    <div class="gb_ucard_c">'),f.push('      <p class="gb_ucard_tit"><span class="text_u">'+(b[d].nick||b[d].account)+"</span>"+(b[d].vip?'<a href="###" class="vip"></a>':"")+"</p>"),f.push('      <p class="queue" style="text-overflow: ellipsis;"><span style="_display:block;_width:92px;_overflow:hidden;_text-overflow: ellipsis;" class="text_id" title="'+b[d].reason+'">'+(b[d].reason||"&nbsp;")+"</span></p>"),f.push('      <p class="queue"><i class="icon icon_sfo"></i></p>'),f.push("    </div>"),f.push("  </div></li>"),j.push(b[d].uin||""));f.push("</ul>");null!=c.scene&&MI.feedBack({name:"Newbie",iPos:c.scene,iBak1:1,sBak2:j.join(","),id:c.id});a.innerHTML=f.join("");var i=$$(a,".gb_ucard_list .unit"),l=function(){UI.hasClass(this,"select")?(UI.removeClass(this,"select"),MI.feedBack({name:"Newbie",iPos:c.scene,iBak1:c.action["单选取消"],sBak2:this.getAttribute("uin"),id:c.id})):(UI.addClass(this,"select"),MI.feedBack({name:"Newbie",iPos:c.scene,iBak1:c.action["单选"],sBak2:this.getAttribute("uin"),id:c.id}));g()==i.length?$("sel_all_chk").checked=!0:$("sel_all_chk").checked=!1};UI.each(i,function(h){h.onclick=l});e.get_count=function(){var h=0;UI.each(i,function(a){UI.hasClass(a,"select")&&h++});return h};e.get_uid_list=function(){var h=[];UI.each(i,function(a){UI.hasClass(a,"select")&&h.push(a.getAttribute("name"))});return h};e.get_uin_list=function(){var a=[];UI.each(i,function(b){UI.hasClass(b,"select")&&a.push(b.getAttribute("uin"))});return a};e.get_uin_list_with_cid=function(){var a=[];UI.each(i,function(b){UI.hasClass(b,"select")&&a.push(b.getAttribute("uin")+":"+(b.getAttribute("cid")||0))});return a};e.get_quan_list=function(){var a={},b;UI.each(i,function(c){UI.hasClass(c,"select")&&(b=UI.A(c,"cid"),a[b]||(a[b]={},a[b].cname=UI.A(c,"cname"),a[b].ulist=[]),a[b].ulist.push(UI.A(c,"name")))});var c=[],d=[],e=[],f=[];UI.each(a,function(a,b){c.push(b);d.push(a.cname);e.push(a.ulist.join(","));f.push(2)});return a={cId:c.join(";"),cName:d.join(";"),accounts:e.join(";"),cType:f.join(";")}};e.select_all=function(a){a?UI.each(i,function(a){UI.addClass(a,"select");$("sel_all_chk").checked=!0}):UI.each(i,function(a){UI.removeClass(a,"select")});g()};$("sel_all_chk").onclick=function(a){e.select_all(UI.E(a).target.checked);UI.E(a).target.checked?MI.feedBack({name:"Newbie",iPos:c.scene,iBak1:c.action["全选"],sBak2:MI.user.uin,id:c.id}):MI.feedBack({name:"Newbie",iPos:c.scene,iBak1:c.action["全选取消"],sBak2:MI.user.uin,id:c.id})};e.select_all(!0);$("btn_follow_and_next").onclick=function(){var a=UI.getEvent();UI.E(a).prevent();a=e.get_uid_list();if(0!=a.length){var b=e.get_uin_list();null!=c.scene&&MI.feedBack({name:"Newbie",iPos:c.scene,iBak1:4,sBak2:b.join(","),id:c.id});MI.ajax({url:MI.url.follow,data:{u:a.join(","),apiType:MI.api.type,lieuId:c.scene,r:MI.random()},success:function(a){if(a&&(a=MI.json(a))&&0===a.result){if($$(".re_qq_tab .add_to_quan")[0]&&$$(".re_qq_tab .add_to_quan")[0].checked){var b=e.get_quan_list()||{};MI.app({"quan/quanDialog":function(){MI.quanCard.doit("quan_Relation_multiAddUser",b,function(){});var a=e.get_uin_list_with_cid();MI.feedBack({name:"qqFriendSelector_auto",iPos:15,iBak1:1,sBak2:a.join(","),id:1744})}})}m&&m(!0)}}})}};$$(".re_qq_tab .add_to_quan")[0]&&($$(".re_qq_tab .add_to_quan")[0].onclick=function(){$$(".re_qq_tab .add_to_quan")[0].checked||(MI.feedBack({name:"Newbie",iPos:c.scene,iBak1:106,id:c.id}),MI.feedBack({name:"qqFriendSelector_cancel_quan",iPos:15,iBak1:1,id:1744}))})}a=a||{};a.iPos=a.iPos||99;a.scene=a.scene||158;a.count=a.count||100;var c={id:1191,scene:a.iPos,action:{"下一步":101,"单选":102,"单选取消":103,"全选":104,"全选取消":105}},g="为你找到了开通微博的QQ好友、熟人朋友，快来收听他们吧！",j="请选择你要收听的人",k=!0,n="http://zhaoren.t.qq.com/asyn/get_quan_tips_data.php",o=!1,p=a.iPos;a.addQuan=0;UI.has([5009,5010],a.scene)?(g="为你找到了兴趣相投的朋友，快来收听他们吧！",a.addQuan=0):UI.has([49],a.scene)?(g="你的QQ好友、朋友们也收听了他们！",j="请选择你要收听的人",k=!0):UI.has([160,158],a.scene)&&(g="为你找到了开通微博的QQ好友，快来收听他们吧!",j="选择你要收听的QQ好友",k=!1,n="http://zhaoren.t.qq.com/asyn/get_cqqtips_data.php");UI.has([5007],a.scene)&&!a.nomore&&(o=!0,p=232);var r=a.addQuan?['<div class="pop_chs_wrap" style="padding-top:0px;">',' <div class="clear"><h3 style="line-height: 30px;" class="left pop_chs_top"> '+g+'</h3><div class="right"><a href="http://zhaoren.t.qq.com/qqfrds.php" style=" display:block; height:30px; line-height:30px;float:right;'+(k?"display:none;":"")+'" onmousedown="MI.Bos(\'qqFriendSelectorMore\')">查看更多<span class="ffsong">&gt;&gt;</span></a></div></div>',' <div class="gb_chsuser">   <div class="gb_chsuser_inner clear">     <div class="gb_chsuser_top clear" style="display:none;">','       <div class="gb_uform" style="line-height:22px">'+j,'       </div>       <\!-- gb_uform //--\>       <div class="gb_sub_tab">         <\!--a class="cur" href="###">全部</a--\>       </div>       <\!-- pop_sub_tab //--\>     </div>     <div id="qz_qqfriend_listview" class="gb_chsuser_bd scroll clear" style="height:268px;">','     <div class="addFollowSourceType" sourceType="'+c.scene+'"></div>','       <ul class="gb_ucard_list clear" style="width:510px;">       </ul>     </div>     <\!-- gb_chsuser_bd //--\>   </div> </div> <\!-- 选用户组件 : //E --\> <div class="pop_cont_bottom">   <label class="check1 re_qq_tab" style="left:10px"><input id="sel_all_chk" type="checkbox" checked="" value="1" style="vertical-align:middle; margin-right:5px"><span style="vertical-align:middle">全选</span></label>   <label class="check1 re_qq_tab" style="left:10px"><input type="checkbox" class="add_to_quan" checked="" value="1" style="vertical-align:middle; margin-right:5px;margin-left:20px!important;"><span style="vertical-align:middle">加入对应微圈</span></label>         <span id="sel_all_txt" class="c_tx5">己选择0人</span>   <a id="btn_follow_and_next" class="gb_btn gb_btn2" href="###">     <span class="t">收听已选</span>   </a> </div></div>'].join(""):['<div class="pop_chs_wrap" style="padding-top:0px;">',' <div class="clear"><h3 style="line-height: 30px;" class="left pop_chs_top"> '+g+'</h3><div class="right"><a href="http://zhaoren.t.qq.com/qqfrds.php" style=" display:block; height:30px; line-height:30px;float:right;'+(k?"display:none;":"")+'" onmousedown="MI.Bos(\'qqFriendSelectorMore\')">查看更多<span class="ffsong">&gt;&gt;</span></a></div></div>',' <div class="gb_chsuser">   <div class="gb_chsuser_inner clear">     <div class="gb_chsuser_top clear">','       <div class="gb_uform" style="line-height:22px">'+j,'       </div>       <\!-- gb_uform //--\>       <div class="gb_sub_tab">         <\!--a class="cur" href="###">全部</a--\>         <span id="sel_all_txt">己选(0)</span>       </div>       <\!-- pop_sub_tab //--\>     </div>     <div id="qz_qqfriend_listview" class="gb_chsuser_bd scroll clear">','     <div class="addFollowSourceType" sourceType="'+c.scene+'"></div>','       <ul class="gb_ucard_list clear" style="width:510px;">       </ul>     </div>     <\!-- gb_chsuser_bd //--\>   </div> </div> <\!-- 选用户组件 : //E --\> <div class="pop_cont_bottom">   <label class="check1 re_qq_tab" style="left:10px"><input id="sel_all_chk" type="checkbox" checked="" value="1" style="vertical-align:middle; margin-right:5px"><span style="vertical-align:middle">全选</span></label>   <a id="btn_follow_and_next" class="gb_btn gb_btn2" href="###">     <span class="t">收听已选</span>   </a> </div></div>'].join(""),q={domain:"http://api.t.qq.com",getQQFriend:function(c){MI.ajax({url:n+"?filter=11&page=1",type:"get",data:{r:MI.random(),scene:a.scene,count:a.count},success:function(a){a=MI.json(a);try{c&&c(a.info.qqfriend.data)}catch(g){c&&c([])}}})},rear:0};this.show=function(){if(location.href.indexOf("?firstin")>0||MI.QQFriendSelector.hasShow)return false;MI.QQFriendSelector.hasShow=true;q.getQQFriend(function(g){if(!(g.length<=0||$("welcome2013"))){var b=new MI.Dialog;b.show({title:'<h1 class="DmainTit">'+(a.scene!=160?"推荐收听":"QQ好友推荐")+"</h1>",width:600,start:function(){setTimeout(function(){new l($("qz_qqfriend_listview"),g,function(){if(o){MI.dialog.showTip({html:"收听成功",delay:3E3});c.scene=p;a.count=100;q.getQQFriend(function(a){setTimeout(function(){MI.dialog.hide();if(a.length<=0)b.hide();else{UI.addClass($$(b._body,".pop_chs_top")[0],"error");$$(b._body,".pop_chs_top")[0].innerHTML="帮你找到了更多的熟人、朋友，快来收听他们吧！";new l($("qz_qqfriend_listview"),a,function(){b.hide();MI.tip("收听成功")})}},1E3)})}else{b.hide();if(a.call&&UI.isFunction(a.call)){a.call();return false}a.scene==160?MI.confirm({type:"success",title:"收听QQ好友成功",content:'更多可能认识的朋友，尽在<a href="http://zhaoren.t.qq.com/qqfrds.php">寻找朋友</a>',confirmTxt:"确定",confirm:function(){MI.dialog.hide()},cancelTxt:""}):MI.tip("收听成功")}})},300)},html:r});UI.EA(b._close,"click",function(){MI.feedBack({name:"Newbie",iPos:c.scene,iBak1:18,id:c.id})})}})}};MI.QQFriendSelector.qqTab=function(){(new MI.QQFriendSelector({iPos:187,scene:5004,addQuan:1})).show()};MI.QQFriendSelector.qqTabNew=function(){(new MI.QQFriendSelector({iPos:187,scene:5007,addQuan:1,nomore:1})).show()}})();/*version:135598*//*  |xGv00|eff3a31b170601d91d1ee1775201a288 */