MIRun(function(){UI.ready(function(){try{MI.microCircle_callback=function(){MI.quan=MI.quan||{};MI.quan.ManageFollowing=function(){function l(){var a;a=0;var b=UI.G("quan_selected_wording");a=UI.GC(".manage_st .select").length;b&&(b.innerHTML=0<a?"已选中("+a+')&nbsp;&nbsp;<a href="javascript:void(0)" onclick="MI.quan_manage_page.unselected(UI.GC(\'.section_main\')[0]);" >取消选择</a>':"");c.float_title&&(0<a?(UI.q(c.float_title,".right .gb_btn").removeClass("gb_disabled"),UI.q(c.float_title,".right .gb_btn").A("title","")):(UI.q(c.float_title,".right .gb_btn").addClass("gb_disabled"),UI.q(c.float_title,".right .gb_btn").A("title","请先选择微圈成员")));return{count:a}}function n(){c.float_title&&(UI.scrollY()>UI.A(c.float_title,"y")?UI.addClass(c.float_title,"prfixed"):UI.removeClass(c.float_title,"prfixed"))}var c={},e={scene_data:{c_top_tab:2,c_sort_cc:2,c_show_cc:2,c_manage_drop:2,c_edit_ccname:3,c_click_avatar:3,c_click_username:3,c_del_user:3,c_manage_cc:3,c_fold:3,c_add_user:3,c_select_recommend:4,c_ignore_recommend:4,c_close_recommend:4,c_click_avatar_recommend:4,c_fold_recommend:4,c_join_recommend_quan:4,c_join_recommend_quan_ok:4,c_dlg_add_user:11,c_dlg_create_cc:10,c_dlg_add_to_quan:9,c_dlg_convert_to_quan:12,rear:null},get_id:function(){return 1744},get_scene:function(a){a=parseInt(e.scene_data[a]||0)||0;return MI.QuanData&&MI.QuanData.scence?MI.QuanData.scence+a:100+a},rear:null},i;c.create=function(){function a(d){return String(UI.A(d,"id")).replace("cid_","")}UI.B.ie6&&UI.each(UI.GC(".item"),function(d){d.onmouseover=function(){UI.addClass(this,"hover")};d.onmouseout=function(){UI.removeClass(this,"hover")}});var b=UI.G("subTab1_mrc")?UI.G("subTab1_mrc"):UI.GC(".mygroup_box_hd")[0]?UI.GC(".mygroup_box_hd")[0]:UI.G("quan_members_count")?UI.G("quan_members_count").parentNode.parentNode.parentNode.parentNode:null;c.float_title=b;c.float_title&&UI.A(c.float_title,"y",UI.getY(c.float_title));UI.EA(window,"scroll",function(){n()});UI.q(".section_recommend .reco_close_btn").EA("click",function(d){var d=UI.E(d).target,d=a(d.parentNode.parentNode.parentNode),f=UI.G("cid_"+d),f=c.get_uin(f);c.remove_recommend_to_quan(d);MI.feedBack({name:"mgr_ignore_recommend_user",id:e.get_id(),iPos:e.get_scene(),iBak2:d,sBak2:String(f)})});UI.q(".section_recommend .join_btn").EA("click",function(d){var d=UI.E(d).target,d=a(d.parentNode.parentNode.parentNode),f=UI.G("cid_"+d),f=c.get_uin(f);c.add_recommend_to_quan(d);MI.feedBack({name:"mgr_join_recommend_user",id:e.get_id(),iPos:e.get_scene(),iBak2:d,sBak2:String(f)})});UI.q(".section_recommend .manage_st .del_btn").EA("click",function(d){var d=UI.E(d).target,f,b;UI.hasClass(d,"del_btn")&&(f=d.parentNode,d=UI.A(f,"uid"),b=UI.A(f,"uid-enc"),f=a(f.parentNode.parentNode),c.remove_recommend_to_quan(f,d),MI.feedBack({name:"mgr_del_recommend_user",id:e.get_id(),iPos:e.get_scene(),iBak2:f,sBak2:String(b)}))});UI.q(".section_main .manage_st").EA("click",function(d){var a=UI.E(d).target,b,e;UI.hasClass(a,"hd")||UI.hasClass(a,"fd")||UI.hasClass(a,"selected_icon")?b=a.parentNode:UI.hasClass(a,"tofh")&&UI.hasClass(a.parentNode,"left")?b=a.parentNode.parentNode.parentNode:UI.hasClass(a,"pr")?b=a.parentNode.parentNode.parentNode:UI.hasClass(a,"left")?b=a.parentNode.parentNode:UI.hasClass(a,"pr")?b=a.parentNode.parentNode.parentNode:UI.hasClass(a,"bz")&&(b=a.parentNode.parentNode.parentNode.parentNode);if(!UI.hasClass(b,"seal_item"))if(e=UI.A(b,"uid"),UI.A(b,"uid-enc"),UI.hasClass(a,"bs")||UI.hasClass(a.parentNode,"bs"))b=a.parentNode.parentNode.parentNode,e=UI.A(b,"uid"),UI.A(b,"ctype",5),UI.E(d).stop(),UI.E(d).prevent(),c.show_join_list(e,b);else if("A"==a.tagName&&UI.hasClass(a.parentNode,"bz")){var j=UI.GC(a.parentNode.parentNode,"a")[0];MI.app({Base:function(){MI.Note.add(j,function(a){j.innerHTML=a.bkname||UI.A(j,"nick");UI.A(j,"note",a.bkname);var b=MI.Card.users[UI.A(j,"account")];if(b)b.bkname=a.bkname})}})}});n();l()};c.new_quan=function(){try{MI.microCircle._on_create_quan=function(a){setTimeout(function(){location.href="http://quan.t.qq.com/quan_set.php?cId="+a},1E3)},MI.microCircle.create_quan(function(){})}catch(a){}};c.add_new_user_to_quan=function(a){try{MI.microCircle.add_user(a,function(){setTimeout(function(){location.reload()},1E3)})}catch(b){}};c.edit_quan=function(a){try{MI.microCircle.edit_name(a,function(){setTimeout(function(){location.reload()},1E3)})}catch(b){}};c.del_quan=function(a){try{MI.feedBack({name:"c_before_del_cc_2",id:1744,iPos:100}),MI.microCircle.del_cc(a,function(){MI.tip("删除成功");setTimeout(function(){MI.feedBack({name:"c_after_del_cc_2",id:1744,iPos:100});location.href="http://t.qq.com/"+MI.user.account+"/following"},1E3)})}catch(b){}};c.add_to_quan=function(a){if(!UI.hasClass(UI.GC(".main .p40 .right .gb_btn")[0],"gb_disabled")){var b=c.get_selected(UI.GC(".section_main")[0]),d=c.get_selected_uin(UI.GC(".section_main")[0]),f=function(a){var c=[];UI.each(a.data,function(a){a.selected&&c.push(a.cid)});0<c.length?(a=50*c.length,500>a&&(a=500),MI.feedBack({name:"c_before_add_to_quan",id:1744,iPos:100}),MI.dialog.showTip({html:"正在加入微圈...",delay:a,end:function(){MI.tip("添加成员成功");MI.feedBack({name:"c_after_add_to_quan",id:1744,iPos:100});setTimeout(function(){location.reload()},1E3)}}),UI.each(c,function(a,d){setTimeout(function(){MI.microCircle.doit("quan_Relation_addUser",{cId:a,accounts:b},function(){})},50*d)}),MI.feedBack({name:"c_dlg_add_to_quan_ok",id:e.get_id(),iPos:e.get_scene("c_dlg_add_to_quan"),iBak2:c.join(),sBak2:d.join(",")})):UI.GC(".addtogroup .dl_manage_bar .err_info")[0].innerHTML="请选择一个微圈"};i||(UI.css(".show_always{display:block!important}"),i=!0);UI.q(".D").remove();var g,h=new MI.Dialog;h.close_dl=function(){h.hide();g=h=null;UI.q(".D").remove()};h.show({title:'<h1 class="DmainTit">添加到微圈</h1>',width:420,start:function(){try{MI.app({"quan/quanDialog":function(){var b=UI.GC(h._wrap,".add_to_quan")[0];g=new MI.QuanDialog;g.build({type:2,tmpl:'<div class="show_always haha" style="display:block !important;"><div class="uc2" style="width:400px">\t<div class="uc_in2 clear"><div class="uc_loading" style="display:block;"><i class="loading"></i>微圈加载中...</div><div class="mcfz" style="display:none;">\t<div class="hd"><span class="tit">把<span class="nick">TA</span>添加到微圈</span></div>\t<div class="bd itembox clear">\t</div>\t<div class="fd"><div class="create" style="display:block"><span class="plus">+</span><a href="#" class="create_btn">新建微圈</a></div><div class="createbox" style="display:none">\t<input type="text" class="text graytxt" value="请输入微圈名称">\t<a href="#" class="gb_btn gb_btn1"><span class="t">新建</span></a>\t<a href="#" class="gb_btn gb_btn5"><span class="t">取消</span></a>\t<span class="err_info"></span></div>\t</div></div><div class="tjst" style="display:none;">\t<div class="hd clear"><div class="left">收听与TA类似的人</div><a href="###" class="right morelink" target="_blank">更多</a>\t</div>\t<ul class="bd clear">\t</ul></div><a href="" class="close_mcfz">×</a>\t</div></div>\t</div>',account:"account,account,account,account",parent:b,nick:"",ipos:e.get_scene("c_dlg_add_to_quan"),start:function(){g.events_hub.listen("Quan_Account_list",function(){a&&UI.each(UI.GC(b,".checkitem"),function(b){UI.A(b,"cid")==a&&UI.remove(b.parentNode.parentNode)})})},selectCall:function(){UI.GC(".addtogroup .dl_manage_bar .err_info")[0].innerHTML=""}})}});UI.q("#add_to_quan_ok").EA("click",function(){if(g){h.data=g.get_data();f&&f(h)}});UI.q("#add_to_quan_close").EA("click",function(){h.close_dl()})}catch(b){}},html:'<div class="addtogroup">  <div class="add_to_quan"></div> <div class="dl_manage_bar fd clear"><div class="left" style="'+(4001==a||4003==a?"display:none":"")+'">  <\!--label><input id="add_to_quan_and_stay" type="checkbox"><span>仍在本微圈保留</span></label--\> </div>  <span class="left err_info"></span>  <div class="right">  <a id="add_to_quan_ok" href="javascript:void(0)" class="gb_btn gb_btn1"><span class="t">确定</span></a>  <a id="add_to_quan_close" href="javascript:void(0)" class="gb_btn gb_btn5"><span class="t">取消</span></a>  </div></div>  </div>'});MI.feedBack({name:"mgr_add_to_quan",id:e.get_id(),iPos:e.get_scene()})}};c.remove_from_quan=function(a){if(!UI.hasClass(UI.GC(".main .p40 .right .gb_btn")[0],"gb_disabled")){var b=c.get_selected(UI.GC(".section_main")[0]),d=c.get_selected_uin(UI.GC(".section_main")[0]);MI.confirm({title:_("您确定要把选中的用户移出微圈？"),content:'<div id="talkListShieldUser">移出后，TA的广播将不会在该微圈中出现。（不会取消收听）</div>',confirm:function(){MI.confirm.hide();MI.dialog.hide();MI.microCircle.doit("quan_Relation_deleteUser",{cId:a,accounts:b},function(){location.reload()});MI.feedBack({name:"dlg_remove_from_quan_ok",id:e.get_id(),iPos:e.get_scene(),iBak2:a,sBak2:d.join(",")})}});MI.feedBack({name:"mgr_remove_from_quan",id:e.get_id(),iPos:e.get_scene(),iBak2:a})}};c.remove_from_quan_base=function(a,b){MI.microCircle.doit("quan_Relation_deleteUser",{cId:b,accounts:a},function(){location.reload()})};c.add_recommend_to_quan=function(a,b){var d=[],f=UI.G("cid_"+a),d=c.get_uid(f);MI.microCircle.doit("quan_Relation_addUser",{cId:a,accounts:d.join(",")},function(){MI.tip("添加成员成功");var a=UI.animate(f,"opacity",0,function(){UI.remove(f);clearInterval(a)},0.4);setTimeout(function(){b&&b();location.reload()},500)})};c.remove_recommend_to_quan=function(a,b,d){var f=[],g=UI.G("cid_"+a),e=!1,j=[],i;if(b&&"string"==typeof b){var k;UI.each(UI.GC(g,".item"),function(a){UI.A(a,"id")=="item_"+b&&(k=UI.A(a,"uid-enc"),i=a)});f.push(k);j.push(b);MI.microCircle.doit("quan_Relation_recommendFeedback",{cId:a,accept:[],reject:f.join(",")},function(){if(e)UI.remove(g);else if(UI.remove(i),0==c.get_uid(g).length){var a=UI.animate(g,"opacity",0,function(){UI.remove(g);clearInterval(a)},1);setTimeout(function(){d&&d();location.reload()},500)}})}else f=c.get_uin(g),j=c.get_uid(g),e=!0,MI.microCircle.doit("quan_Relation_ignoreRecoUser",{cId:a},function(){var a=UI.animate(g,"opacity",0,function(){UI.remove(g);clearInterval(a)},1);setTimeout(function(){d&&d();location.reload()},500)})};c.update_join_list_caption=function(a,b){try{var d;d="string"==typeof a?c.find_dom_by_account(a,UI.GC(".section_main")[0]):a;b=b||[];0==b.length&&b.push("未分组");var f=b.join("/");UI.GC(d,".fd .tofh")[0].innerHTML=8<f.length?f.substr(0,8)+"..":f;UI.A(UI.GC(d,".fd .tofh")[0],"title",b.join(","))}catch(e){}};c.show_join_list=function(a,b){1==UI.A(b,"show")?(MI.quanCard.hide(),UI.q(".manage_st .item").A("show",""),UI.q(".manage_st .item .bs").removeClass("open")):(MI.app({"quan/quanDialog":function(){MI.quanCard.build({type:2,account:a,el:b,nick:"",ipos:e.get_scene(),start:function(){try{$$(MI.quanCard._body,".caret_out")[0].style.left="80px",$$(MI.quanCard._body,".caret_in")[0].style.left="81px"}catch(a){}UI.q(".manage_st .item").A("show","");UI.q(".manage_st .item .bs").removeClass("open");UI.A(b,"show",1);UI.q(b,".bs").addClass("open")},hideCall:function(){UI.q(".manage_st .item").A("show","");UI.q(".manage_st .item .bs").removeClass("open")},selectCall:function(a){var f=[];UI.each(a,function(a){a.selected&&f.push(a.cname)});c.update_join_list_caption(b,f)}})}}),MI.feedBack({name:"mgr_show_join_list",id:e.get_id(),iPos:e.get_scene(),sBak2:a}))};c.convert_to_quan=function(a,b,d,c){i||(UI.css(".show_always{display:block!important}"),i=!0);UI.css(".show_always{display:block!important}");UI.q(".D").remove();var d='\t<div class="changetogroup"><div class="hd c_tx5">你可以把此名单转变成新微圈或合并到已有微圈：</div><div class="bd">\t<div class="tab clear"><div class="tab_item current" rel="newgroup" onclick="UI.q(\'.changetogroup .tab_item\').removeClass(\'.current\'); UI.addClass(this,\'current\');  UI.q(\'.changetogroup .tab_content\').hide(); UI.q(\'.changetogroup .\' + UI.A(this, \'rel\')).show();">\t<i class="ico ico_zb"></i><span>转变成新微圈</span>\t<b class="a a5 a_t"></b></div><div class="tab_item" rel="custom_mc" onclick="UI.q(\'.changetogroup .tab_item\').removeClass(\'.current\'); UI.addClass(this,\'current\');  UI.q(\'.changetogroup .tab_content\').hide(); UI.q(\'.changetogroup .\' + UI.A(this, \'rel\')).show();">\t<i class="ico ico_hb"></i><span>合并到已有微圈</span>\t<b class="a a5 a_t"></b></div>\t</div>\t<div class="tab_content newgroup"><div class="inner clear">\t<span class="left">新微圈：</span>\t<div class="left"><input type="text" class="text" value="'+(d||"")+'"><div class="c_tx4"></div>\t</div></div>\t</div>\t<div class="tab_content custom_mc" style="display:none"><div class="mcfz" style="display:block !important"></div></div>\t<div class="btn"><a href="javascript:void(0)" id="convert_to_quan_ok" class="gb_btn gb_btn1"><span class="t">确认</span></a><a href="javascript:void(0)" id="convert_to_quan_close" class="gb_btn gb_btn5"><span class="t">取消</span></a>\t</div></div>\t</div>',g,h=new MI.Dialog;h.close_dl=function(){h.hide();g=h=null;UI.q(".D").remove()};h.show({title:'<h1 class="DmainTit">转变为微圈</h1>',width:550,start:function(){MI.app({"quan/quanDialog":function(){var a=UI.GC(h._wrap,".custom_mc .mcfz")[0];g=new MI.QuanDialog;g.build({type:2,tmpl:'<div class="show_always" style="display:block !important;"><div class="uc2">\t<div class="uc_in2 clear"><div class="uc_loading" style="display:block;"><i class="loading"></i>微圈加载中...</div><div class="mcfz" style="display:none;">\t<div class="bd itembox clear">\t</div>\t<div class="fd" style="display:none"><div class="create" style="display:block"><span class="plus">+</span><a href="#" class="create_btn">新建微圈</a></div><div class="createbox" style="display:none">\t<input type="text" class="text graytxt" value="请输入微圈名称">\t<a href="#" class="gb_btn gb_btn1"><span class="t">新建</span></a>\t<a href="#" class="gb_btn gb_btn5"><span class="t">取消</span></a>\t<span class="err_info"></span></div>\t</div></div><div class="tjst" style="display:none;">\t<div class="hd clear"><div class="left">收听与TA类似的人</div><a href="###" class="right morelink" target="_blank">更多</a>\t</div>\t<ul class="bd clear">\t</ul></div><a style="display:none" href="" class="close_mcfz">×</a>\t</div></div>\t</div>',account:"account,account,account,account",parent:a,ipos:e.get_scene("c_dlg_convert_to_quan"),item_tmpl:'<div class="item"><label>\t<input type="radio" name="_radio" class="checkitem" cid="{0}" ctype="{1}">\t<span>{2}</span>{3}</label><div class="ui_ico_s" >\t<i class="ui_sucico"></i>\t<span>添加成功</span></div>\t</div>',item_tmpl_create:'<div class="item"><label>\t<input type="radio" name="_radio" class="checkitem" cid="{0}" ctype="{1}">\t<span>{2}</span>{3}</label><div class="ui_ico_s" style="display:inline;">\t<i class="ui_sucico"></i>\t<span>创建成功</span></div>\t</div>',nick:"",start:function(){g.events_hub.listen("Quan_Account_list",function(){UI.each(UI.GC(a,".item input"),function(a){UI.A(a,"cid")=="4002"&&UI.remove(a.parentNode.parentNode)});if(UI.GC(a,".checkitem").length>0)UI.GC(a,".checkitem")[0].checked=true})},selectCall:function(){}})}});var d=UI.GC(h._wrap,".newgroup input.text")[0],i=UI.GC(h._wrap,".newgroup .c_tx4")[0],k=function(){return MI.microCircle.validate_form.check_name(d,i)};UI.EA(d,"change",function(){k()});UI.EA(d,"keyup",function(){k()});var m=UI.G("convert_to_quan_ok"),l=function(){if(!UI.hasClass(m,"gb_disabled")&&g){MI.quanAjax&&MI.quanAjax.abort();UI.addClass(m,"gb_disabled");if(UI.hasClass(UI.GC(".changetogroup .tab_item")[1],"current")){h.data=g.get_data();var i=[];UI.each(h.data,function(a){a.selected&&i.push(a.cid)});MI._alert_close=function(){location.reload()};MI.microCircle.events_hub.bind("quan_Relation_listToQuan",function(a){if(a.result==0){MI.tip("微圈转换成功");setTimeout(function(){location.reload()},2E3)}setTimeout(function(){UI.removeClass(m,"gb_disabled")},3E3)});MI.microCircle.doit("quan_Relation_listToQuan",{cId:i.join(),listId:a,listType:b},function(){});MI.feedBack({name:"c_dlg_convert_to_quan_ok",id:e.get_id(),iPos:e.get_scene("c_dlg_convert_to_quan"),iBak2:i.join(),sBak1:a})}else if(k()){MI._alert_close=function(){location.reload()};MI.microCircle.events_hub.bind("quan_Relation_listToQuan",function(a){if(a.result==0){MI.tip("微圈转换成功");setTimeout(function(){location.reload()},2E3)}setTimeout(function(){UI.removeClass(m,"gb_disabled")},3E3)});MI.microCircle.doit("quan_Relation_listToQuan",{circleName:d.value,listId:a,listType:b},function(){UI.q("#convert_to_quan_ok").ER("click",l)});MI.feedBack({name:"c_dlg_convert_to_quan_create_ok",id:e.get_id(),iPos:e.get_scene("c_dlg_convert_to_quan"),sBak1:a})}else UI.removeClass(m,"gb_disabled");c&&c(h)}};UI.q("#convert_to_quan_ok").EA("click",l);UI.q("#convert_to_quan_close").EA("click",function(){h.close_dl()})},html:d});MI.feedBack({name:"mgr_convert_to_quan",id:e.get_id(),iPos:e.get_scene(),sBak1:a})};c.find_dom_by_account=function(a,b){var d;UI.each(UI.GC(b||document,".manage_st .item"),function(b){UI.A(b,"uid")==a&&(d=b)});return d};c.get_selected=function(a){var b=[];UI.each(UI.GC(a||document,".manage_st .select"),function(a){b.push(UI.A(a,"uid"))});return b};c.get_selected_uin=function(a){var b=[];UI.each(UI.GC(a||document,".manage_st .select"),function(a){b.push(UI.A(a,"uid-enc"))});return b};c.get_uid=function(a){var b=[];UI.each(UI.GC(a||document,".manage_st .item"),function(a){b.push(UI.A(a,"uid"))});return b};c.get_uin=function(a){var b=[];UI.each(UI.GC(a||document,".manage_st .item"),function(a){b.push(UI.A(a,"uid-enc"))});return b};c.unselected=function(a){UI.q(a||document,".manage_st .item").removeClass("select");l();MI.feedBack({name:"mgr_unselect_all_user",id:e.get_id(),iPos:e.get_scene()})};c.followCall=function(a,b,d){MI.Wide.FollowBtn.followCall(a,b,d)};c.unfollowCall=function(a,b,d){MI.Wide.FollowBtn.unfollowCall(a,b,d);try{var c=b.parentNode.parentNode,c=UI.prev(c);UI.GC(c,".t")[0].value="收听"}catch(e){}};c.unfollowBlockedUserCall=function(a,b,d){try{var c=b.parentNode.parentNode,e=UI.parseUrl();c.innerHTML=4002==e.cId||4001==e.cId||void 0==e.cId?'<span class="t">已取消收听</span>':'<span class="t"><a href="###" onclick="MI.quan_manage_page.remove_from_quan_base(\''+d+"','"+e.cId+"')\">移出该圈</a></span>";UI.show(c)}catch(h){}};return c};MI.quan_manage_page=new MI.quan.ManageFollowing;MI.quan_manage_page.create()},MI.microCircle_filter=2,UI.getScript("http://mat1.gtimg.com/www/mb/js/quan/quan.index_141120.js")}catch(o){trace(o.stack)}})});/*version:149034*//*  |xGv00|b34eab7d4141e14882879b0058477159 */