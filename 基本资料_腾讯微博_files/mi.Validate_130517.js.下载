(function(){var c=UI.G,p=UI.GC;if(!window.MIApp||window.MIApp.lib)window.$=UI.G,window.$$=UI.GC;MI.Validate=function(a){function k(a){var g,e,c,h,d=0,i=0,m={};UI.isString(a)?i=1:(g=UI.E(a),a=UI.A(g.target,"name"));e=b.data.inputs[a];f=e.target;c=f.value;if(!e.removed){e.replace&&(h=e.replace(c),c!=h&&(f.value=h));if(i||f.blured)if(d=e.rule?e.rule(f.value,i):0)b.showMessage(e,d),i&&b.flashMessage(e),f.error=1,b.success=0;else if(!e.url||e.url&&f.focused)b.hideMessage(e),f.error=0;m[a]=c;!i&&(!d&&e.url&&f.blured&&"blur"==g.type&&UI.trim(c))&&MI.ajax({url:UI.isFunction(e.url)?e.url():e.url,type:"get",data:m,success:function(a){a=MI.json(a);if(a.result==0)b.hideMessage(e);else{b.showMessage(e,a.msg);b.success=0}}})}}this.data=a;this.check=a.check;this.lastCheck=a.lastCheck;this.isAjax=void 0==a.isAjax?1:a.isAjax;this._body=c(a.id);if(!this._body)return this;var b=this,n,l,o=0,g,f;UI.isFunction(a.messages)&&(n=1);for(var j in b.data.inputs)if(g=b.data.inputs[j],f=g.target=c(j)){n?g.message=a.messages(a.inputs[j].target):(g.message=a.messages[o],o++);l=UI.A(g.message,"rel");if(!l&&(""!=l||!UI.hasClass(g.message,"error")))UI.A(g.message,"rel",g.message.innerHTML||"");g.ico=UI.html('<b class="pass" style="display:none"></b>')[0];UI.after(g.ico,g.target);f.onfocus=function(){this.ico=0;this.focused=1};f.onblur=function(){this.ico=this.blured=1;this.focused=0};UI.EA(f,"blur",k);UI.EA(f,"keyup",k)}else delete b.data.inputs[j];a=function(a){function g(){b.xhr||(b.xhr=MI.ajax({url:UI.A(b._body,"action"),data:e,success:function(a){var a=MI.json(a),d=0,f=1,c;if(0==a.result){if(a.info)for(var h in b.data.inputs){c=b.data.inputs[h];if(a.info[d])if(0==a.info[d].result)c.removed||(c.success?b.showMessage(c,c.success,1):b.hideMessage(c),c.remove&&(UI.A(c.target,"disabled","disabled"),c.removed=1));else{if(c.onError)c.onError(a.info[d]);else b.showMessage(c,a.info[d].msg);f=0}d++}f&&b.data.success&&b.data.success(a)}else MI.code.check(a.result)?MI.code.show({msg:a.msg,code:a.info,call:function(a){e.veriCode=a;g()}}):a.msg&&MI.alert(a.msg);b.xhr=null}}))}var a=UI.E(a),e={},f,h;b.success=1;b.isAjax&&a.prevent();for(var d in b.data.inputs)k(d);if(!b.check||!b.check())if(b.success&&b.isAjax){for(d in b.data.inputs){a=c(d);f=UI.A(a,"name");if("radio"==a.type||"checkbox"==a.type)h=[],UI.each(p(b._body,"input"),function(a){UI.A(a,"name")==f&&h.push(a)});if("radio"==a.type)for(var a=0,i=h.length;a<i;a++){if(h[a].checked){e[d]=h[a].value;break}}else if("checkbox"==a.type)if(1==h.length)c(d).disabled||(e[d]=b.data.inputs[d].result?b.data.inputs[d].result(c(d).value):c(d).value);else{if(1<h.length){e[d]=[];a=0;for(i=h.length;a<i;a++)h[a].checked&&e[d].push(h[a].value)}}else e[d]=b.data.inputs[d].result?b.data.inputs[d].result(c(d).value):c(d).value}(!b.lastCheck||!b.lastCheck())&&g()}else b.success||a.prevent()};"form"==b._body.tagName.toLowerCase()?UI.EA(b._body,"submit",a):b._body.onsubmit=a};MI.Validate.prototype={xhr:null,showMessage:function(a,c,b){c||(c=UI.A(a.message,"rel"));a.message.innerHTML=c;UI.addClass(a.message,b?"success":"error");!a.noIco&&b?UI.show(a.ico):UI.hide(a.ico)},hideMessage:function(a){a.message.innerHTML=UI.A(a.message,"rel")||"";UI.removeClass(a.message,"error");UI.removeClass(a.message,"success");!a.noIco&&a.target.ico&&UI.show(a.ico)},clearMessage:function(){for(var a in this.data.inputs)this.hideMessage(this.data.inputs[a])},flashMessage:function(a){clearInterval(a.delay);UI.C(a.message,"opacity",0);a.delay=UI.animate(a.message,"opacity",1)}}})();/*version:106555*//*  |xGv00|fd0dae8bcf5374c591f01f05a6da4e19 */