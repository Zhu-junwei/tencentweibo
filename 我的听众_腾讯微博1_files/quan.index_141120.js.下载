MI["quan/quan.index"]=1;function ___fixeIEhash(){try{var k=window.document.title;-1!=k.indexOf("#")&&(k=k.substring(0,k.indexOf("#")));window.document.title=k}catch(q){}}function EventsDispacther(){var k=100,q={},g={bind:function(d,l){g.unbind(d);g.listen(d,k,l)},unbind:function(d){g[d]=null;delete g[d]},_q:function(){return g},listen:function(d,l,o){if(d){g[d]||(g[d]={});if(!o)return g[d][k]=l,q[k]=d,k++,k-1;g[d][l]=o;q[l]=d;return l}},unlisten:function(d,l){try{if("number"==typeof d){var o=q[d];g[o][d]=null;delete g[o][d];q[d]=null;delete q[d]}else g[d][l]=null,delete g[d][l];return!0}catch(k){return trace&&trace("can not unlisten event",d,l,k),!1}},listen_obj:function(d){if(d&&"object"==typeof d)for(var l in d)g.listen(l,d[l])},dispatch_all:function(d){try{if(g.on_dispatch)for(var l in d)g.exec("on_dispatch",[l,d[l]]),g.exec(l,[d[l]]);else for(l in d)g.exec(l,[d[l]])}catch(o){trace&&trace(o)}},exec:function(d,l){try{var o=l||[];if(g[d]){var k=g[d],n;for(n in k)k[n]&&k[n].apply(k,o)}}catch(m){trace&&trace(m)}},dispatch:function(d,l){if("string"==typeof d){var o;g.exec(d,l)}else if("object"==typeof d||"array"==typeof d)for(o in d)g.exec(o,d[o]);else trace&&trace("can not dispatch "+d)}};return g}MIRun(function(){UI.ready(function(){try{UI.getScript("http://mat1.gtimg.com/www/mb/js/search/ui.q.common_121019.js",function(){UI.getScript("http://mat1.gtimg.com/www/mb/js/search/ui.q_121019.js",function(){UI.css(".AL .newsBox2 {position: relative;z-index: 1;height: 23px;margin: 7px 29px 0;border: 1px solid #F4E4B4;background-color: #FFF4D8;display: none;}.AL .newsBox2 a {display: block;width: 100%;height: 22px;padding-top: 1px;color: #EFAA00;text-align: center;}");MI.CircleMemberSelector=function(){var g=this;g.create=function(d){UI.q(".add_to_quan_list").remove();g._memberForm=UI.html('<div class="add_to_quan_list pop_chs_wrap"><div class="pop_chs_top_textbox"></div><h3 class="pop_chs_top">选择要添加到该微圈的用户<\!--span class="cNote">（'+_("一次最多添加{0}人",20)+'）</span--\></h3><div class="gb_chsuser"></div><div class="pop_cont_bottom">\t<span class="text_error"></span>\t<a class="gb_btn gb_btn2" href="#"><span class="t">'+_("完成")+'</span></a>\t<a class="gb_btn gb_btn6" href="#"><span class="t">'+_("取消")+"</span></a></div>\t</div>")[0];g.alert=new MI.Dialog;g.alert.show({title:'<h1 class="DmainTit">'+(d.title||"")+"</h1>",html:g._memberForm,width:500,start:function(){var l=$$(g._memberForm,".gb_chsuser")[0],k=$$(g._memberForm,".text_error")[0],q=$$(g._memberForm,".gb_btn2")[0],n=$$(g._memberForm,".gb_btn6")[0],m,c,r;q.onclick=function(){if(r){var c=r.memeberResult();0==c.result&&c.info&&(g.on_ok&&g.on_ok(c.info.member),r.memberReset())}return!1};n.onclick=function(){g.close_dlg();r&&r.memberReset();g.on_cancel&&g.on_cancel();return!1};MI.versionSet({ItemSelect:"130416"});MI.app({ItemSelect:function(){r=new MI.ItemSelectMember({target:l,type:1,tips:k,memberNotingTips:'<div class="noteBox">  </div>',call:function(c){d.on_select&&d.on_select(c)}});g.memberItemSelect=r;g.memberItemSelect.get_accounts=function(){var c=[];UI.each(g.memberItemSelect.list,function(d){c.push(UI.A(d,"account"))});return c};d.on_create&&d.on_create();var n=UI.GC(g._memberForm,".atSearch .inputTxt")[0];UI.EA(n,"change",function(){d.on_search&&d.on_search(n.value)});m=$$(g._memberForm,".gb_sub_tab a")[0];c=$$(g._memberForm,".gb_sub_tab a")[1];UI.EA(m,"click",function(){d.on_tabs&&d.on_tabs("all")});UI.EA(c,"click",function(){d.on_tabs&&d.on_tabs("selected")})}})},end:function(){g.memberItemSelect&&g.memberItemSelect.memberReset()}})};g.close_dlg=function(){g.alert.hide()};return g};MI.microCircle=new function(){function g(){var b=[],a=[];UI.each(UI.GC(UI.G("recommend_mrc"),".item_group .item"),function(f){var c=UI.A(UI.GC(f,".inner")[0],"uin");UI.hasClass(f,"selected")?b.push(c):a.push(c)});UI.show("m_relation_circle");UI.hide("recommend_mrc");c.doit("quan_Relation_recommendFeedback",{accept:b.join(),reject:a.join()},function(){MI.tip("添加成员成功");k()})}function d(){UI.show("m_relation_circle");UI.hide("recommend_mrc");c.doit("quan_Relation_ignoreRecoUser")}function l(b,a){try{if(null==a||void 0==a)a="查看"==UI.GC(b,"a")[0].innerHTML?!0:!1;var f=function(){UI.GC(b,"a")[0].innerHTML="收起";UI.GC(b,".a4")[0].className="a a4 a_b";UI.removeClass(UI.G("m_relation_circle"),"hidden_state")};a?null!=e.users_req_count?(e.users_req_count=null,f(),c.doit("quan_Relation_groupMember",null,function(){UI.show("m_relation_circle");f();/ *json_data.data[selected_ccid]._wording_is_show = false;*/;e.is_show_wording=!1})):f():(UI.GC(b,"a")[0].innerHTML="查看",UI.GC(b,".a4")[0].className="a a4 a_t",UI.addClass(UI.G("m_relation_circle"),"hidden_state"))}catch(u){}}function k(){try{var b=e.data[h].grpName||"微圈",a=e.users_count||e.users.length||0,f=s._circle_tips_0;3==(e.data[h].wGrpType||2)?f=s._circle_tips_1:"4003"==String(h)?f=s._circle_tips_0_follow_each_other:"4004"==String(h)&&(f=s._circle_tips_0_qq);UI.G("m_relation_circle_tips").innerHTML=_(f,a,b);UI.G("m_relation_circle_count_1").innerHTML=a;e.is_show_wording||(UI.GC(UI.G("m_relation_circle"),".primary_suck_tip")[0].innerHTML="",UI.hide(UI.GC(UI.G("m_relation_circle"),".primary_suck_tip")[0]))}catch(c){}}function q(b){null==UI.G("m_relation_circle_wrapper")&&MI.TalkListTab.showCont('<div id="m_relation_circle_wrapper"></div>');null==UI.G("m_relation_circle")?(MI.TalkListTab.showCont(),UI.G("m_relation_circle_wrapper").appendChild(UI.html(A)[0])):MI.TalkListTab.showCont();UI.show("m_relation_circle");var a=b.data[h].op||{},f=[],u="";a.hasRepName&&f.push('<a e="c_edit_ccname" href="javascript:void(0)">修改圈名</a><span>');a.hasMng&&f.push('<a target="_blank" e="c_manage_cc" href="http://quan.t.qq.com/quan_set.php?cId='+h+'">管理微圈</a>');u=f.join("<span> | </span>");UI.GC(UI.G("m_relation_circle"),".toolbar")[0].innerHTML=u?'<div class="mrc_fd clear"><div class="right"><div class="c_tx5">'+u+"</div></div></div>":"";for(var u=f="",d=[],g=0,B=b.users.length;g<B;g++){var i=b.users[g];i.avatar_100=i.avatar?i.avatar+"/100":"http://qzonestyle.gtimg.cn/ac/qzone_v5/avatar/100/5001.jpg";i.avatar_50=i.avatar?i.avatar+"/50":"http://qzonestyle.gtimg.cn/ac/qzone_v5/avatar/50/5001.jpg";var x=i.flag.isBanedUser,n="",m=x?"javascript:void(0)":"http://t.qq.com/"+i.name,r=x?"":' title="去Ta的主页看看" ',p=x?"":' target="_blank" ',v=x?'<div class="seal_pn"><div class="seal_inner">已封禁</div></div>':"";a.hasDelUser&&(n='<div class="del_this"><div class="del_bg"><a '+(x?' class="disabled" ':"")+' e="c_click_avatar" account="'+i.name+'" href="'+m+'" '+r+p+'></a></div><a href="javascript:void(0)" e="c_del_user" title="移出该圈" account="'+i.name+'"></a></div>');f=f+'<div id="circle_firend_item_'+i.name+'" class="item" onmouseover="UI.addClass(this, \'hover\')" onmouseout="UI.removeClass(this, \'hover\')" >'+n+v+'\t<div class="inner"><a target="_blank" href="'+m+'"><img src="'+i.avatar_50+'" alt="" class="user_pic" /></a><div class="user_name"><a '+(x?' class="disabled" ':"")+' target="_blank" e="c_click_username" account="'+i.name+'" href="'+m+'" title="'+i.nick+'">'+MI.string.html(MI.string.cut(i.nick,10,".."))+"</a></div>\t</div></div>";9>g&&(u+='<a id="tiny_icon_'+i.name+'" target="_blank" title="'+i.nick+'" href="http://t.qq.com/'+i.name+'"><img src="'+i.avatar_50+'" alt=""></a>');d.push(i.name)}a.hasAddUser&&(f+='<div class="add_user" e="c_add_user"><a href="javascript:void(0)"  e="c_add_user" title="添加新成员"></a></div>');UI.G("m_relation_circle_item_group")&&(UI.G("m_relation_circle_item_group").innerHTML=f);UI.G("m_relation_circle_tiny_icons")&&(UI.G("m_relation_circle_tiny_icons").innerHTML=u);var y=0,t=0;UI.each(e.data,function(a){if(!UI.isUndefined(a.firstFlag)){y=y+a.firstFlag;t++}});!0==e.data[h].selfCreate?l(UI.GC(UI.G("m_relation_circle"),".m_btn_fold")[0],!1):0==t?l(UI.GC(UI.G("m_relation_circle"),".m_btn_fold")[0],!1):l(UI.GC(UI.G("m_relation_circle"),".m_btn_fold")[0],!y);k();0==y&&(e.is_show_wording=!0);UI.isUndefined(e.data[h].firstFlag)||(0==e.data[h].firstFlag&&(UI.GC(UI.G("m_relation_circle"),".primary_suck_tip")[0].innerHTML='<div e="c_fold" style="padding:5px 10px 5px 5px">我们将你收听的'+Number(e.users_count)+"人智能分到了该微圈，若个别有误辛苦修正一下吧。</div>",UI.show(UI.GC(UI.G("m_relation_circle"),".primary_suck_tip")[0])),e.data[h].firstFlag=1);c.is_create_quan=!1;MI.feedBack({name:"c_user_expose",id:j.get_id(),iPos:j.get_scene()+3,iBak2:h,sBak2:d.join()})}function n(b){try{for(var a=[],f=[],c="更多微圈",d=0,g=b.sort.length;d<g;d++){var l=b.sort[d];3>d?a.push(l):f.push(l)}l=[];d=0;for(g=a.length;d<g;d++){var i=a[d],k=b.data[i],n=0<e.newCount_data[i]&&i!=h?MI.string.sprintf('<sup e="c_show_cc" boss_scene="51" ccid="%s" class="ico_newMsg"><b e="c_show_cc" boss_scene="51" ccid="%s" >new</b></sup>',i,i):"",m="";i==h&&(m="select");l.push('<li id="tab_quan_'+i+'" class=" '+m+' unit"><a e="c_show_cc" boss_scene="5'+d+'" ccid="'+i+'" href="javascript:void(0)" title="'+k.grpName+'" class="t"><span e="c_show_cc" boss_scene="5'+d+'" ccid="'+i+'" class="text">'+MI.string.html(8>=MI.string.length(k.grpName)?k.grpName:MI.string.cut(k.grpName,7,".."))+"</span></a>"+n+"</li>")}for(var o=[],a=!1,q=3>=b.sort.length?!0:!1,d=0,g=f.length;d<g;d++){i=f[d];k=b.data[i];n=0<e.newCount_data[i]&&i!=h?MI.string.sprintf('<sup e="c_show_cc" ccid="%s" class="ico_newMsg"><b e="c_show_cc" ccid="%s" >new</b></sup>',i,i):"";k.grpName=String(k.grpName||"默认微圈");m="";if(i==h)var m="select",a=!0,p=b.data[h].grpName||"",c=b.data[h]&&MI.string.html(8<p.length?p.substr(0,8)+"..":p)||"更多微圈";o.push('<div id="tab_quan_'+i+'" class="'+m+'"><a e="c_show_cc" ccid="'+i+'" href="javascript:void(0)" _title="'+k.grpName+'"><i class="ic ic_selected"></i><span class="pr" e="c_show_cc" ccid="'+i+'">'+MI.string.html(8<k.grpName.length?k.grpName.substr(0,8)+"..":k.grpName)+n+'</span><i style="display:none;" class="ic_top_mrc" e="c_top_tab" ccid="'+i+'" title="置顶"><em e="c_top_tab" ccid="'+i+'" class="ic"></em></i></a></div>')}b.other&&(o.push('<div class="hr"></div>'),UI.each(b.other,function(a){var b="";a.count&&(b='<span class="c_tx5">('+a.count+")</span>");o.push('<div class=""><a href="'+a.href+'" target="_blank" title="跳转到'+a.name+'"><i class="ic ic_selected"></i>'+a.name+b+'<i class="topage"></i></a></div>')}));var y=l.join("")+r.replace("{{is_hide_more_menu}}",!0==q?" display:none ":"").replace("{{is_selected_in_menu}}",!0==a?" select ":"").replace("{{menu}}",o.join("")).replace("{{more_text}}",c);v.innerHTML=y;var t=UI.GC(v,".last")[0];UI.GC(t,".ui_drop_follows_mod");var s,w;UI.EA(UI.GC(t,".more a .text")[0],"mouseover",function(){MI.feedBack({name:"c_more",id:j.get_id(),iPos:j.get_scene(),iBak1:2,iBak2:h})});UI.EA(t,"mouseover",function(){s!=null&&clearTimeout(s);s=null;w=setTimeout(function(){UI.addClass(t,"hover")},100)});UI.EA(t,"mouseout",function(){clearTimeout(s);clearTimeout(w);s=setTimeout(function(){UI.removeClass(t,"hover")},50)})}catch(z){}}function m(){function b(a,b){try{var f="",a=a||{},c;for(c in a)null!=a[c]&&(f+="&"+c+"="+a[c]);f="http://quan1.t.qq.com/e/quan_Message_index?cId="+h+f+"&";try{UI.q("#talkNew").style({height:"1px",visibility:"hidden",margin:"0px",overflow:"hidden"})}catch(e){}MI&&MI.talkBox&&(MI.talkBox.addList=0);MI.TalkListTab.show("quan");MI.TalkListTab.load({url:f});b&&b()}catch(d){}}try{if(UI.hide($$(".tab_s_wrap")[0]),UI.hide($$(".m_tip_tl")[0]),!UI.G("talkList")){var a=UI.html('<ul id="talkList" class="LC"></ul>')[0],f=UI.html('<ul><li id="listLoading" class="loading2" style="height:700px;background-position:50% 100px;border-bottom:0!important;"> </li></ul>')[0];UI.append($$($("mainWrapper"),".AL")[0],a);UI.append($$($("mainWrapper"),".AL")[0],f)}}catch(c){}MI.user.fun.pageMode?b({page:1},function(){}):b()}var c={},r='<li class="unit last {{is_selected_in_menu}} " style="{{is_hide_more_menu}}">\t<div class="more"><a href="javascript:void(0)" class="t"><span class="text">{{more_text}}</span><span class="arr"><b class="a a4 a_t"></b></span></a><div class="ui_drop ui_drop_follows_mod">\t<div class="ui_drop_in"><div class="ui_drop_body">\t<div class="ui_drop_lst ui_drop_follows_lst"><div class="">{{menu}}</div><div class="management_pn"><a e="c_sort_cc" href="javascript:void(0)">排序</a><span class="stp">|</span><a e="c_manage_drop" href="http://t.qq.com/'+MI.user.account+'/following" target="_blank">管理</a></div>\t</div></div>\t</div></div>\t</div></li>',A='<div id="m_relation_circle" class="m_relation_circle">  <div e="c_fold" class="primary_suck_tip mrc_hd clear" style="display:none; position:absolute; width:510px; padding:0; color:#999;"></div>\t<div e="c_fold" class="mrc_hd clear"><div class="left">\t<div class="ex_1 c_tx5" e="c_fold" id="m_relation_circle_tips">这些用户在该微圈</div>\t<div class="ex_2 c_tx5"><div id="m_relation_circle_tiny_icons" class="pic"></div><span class="c_tx5" e="c_fold">等<em e="c_fold" id="m_relation_circle_count_1">0</em>人在<\!--em e="c_fold" id="m_relation_circle_name"></em--\>这里</span></div></div><div class="right"><div class="m_btn_fold" e="c_fold"><a href="javascript:void(0)" e="c_fold">收起</a><b class="a a4 a5b a_b a_b2" e="c_fold"><u e="c_fold"></u></b></div></div>\t</div>\t<div class="mrc_bd"><div class="scrollbar" style="overflow-x:hidden;overflow-y:auto;">\t<div class="item_group clear" id="m_relation_circle_item_group">\t</div></div>\t</div>\t<div class="toolbar"><div class="mrc_fd clear"><div class="right"><div class="c_tx5"><a e="c_edit_ccname" href="javascript:void(0)">修改圈名</a><span> | </span><a e="c_del_cc" href="javascript:void(0)">管理微圈</a></div></div>\t</div></div></div>',s={_circle_tips_0:"{0}位用户在“{1}”微圈",_circle_tips_0_qq:"本圈{0}位成员通过您的QQ好友信息匹配，仅可浏览查看。",_circle_tips_0_follow_each_other:"本圈{0}位成员通过您的微博互听关系匹配，仅可浏览查看。",_circle_tips_0_new:"我们将你收听的{0}人智能分到了“{1}”微圈，若个别有误辛苦修正一下吧！",_circle_tips_1:"根据您的资料智能匹配的{0}位用户在“{1}”微圈",_recommend_tips_0:"推荐你收听的{0}位用户",_recommend_tips_1:"已选{1}人"},z={check_name:function(b,a){var f=!1,f=String(b.value),c=f.match(/[\u4e00-\u9fa5A-Za-z0-9]/g);16<MI.string.length(f)?(a.innerHTML="最多输入8个字",f=!1):""==UI.trim(f)?(a.innerHTML="请至少输入一个名字",f=!1):c&&c.length!=f.length?(a.innerHTML="只能包含中英文字符或数字",f=!1):(a.innerHTML="",f=!0);return f}};c.validate_form=z;for(var j={scene_data:{c_top_tab:2,c_sort_cc:2,c_show_cc:2,c_manage_drop:2,c_edit_ccname:3,c_click_avatar:3,c_click_username:3,c_del_user:3,c_manage_cc:3,c_fold:3,c_add_user:3,c_select_recommend:4,c_ignore_recommend:4,c_close_recommend:4,c_click_avatar_recommend:4,c_fold_recommend:4,c_join_recommend_quan:4,c_join_recommend_quan_ok:4,c_dlg_add_user:11,c_dlg_create_cc:10,rear:null},get_id:function(){return 1744},get_scene:function(b){b=parseInt(j.scene_data[b]||0)||0;return MI.QuanData&&MI.QuanData.scence?MI.QuanData.scence+b:100+b},rear:null},p={t:[+new Date],topSpan:function(b){this.site=b;p.t[1]=+new Date},endCheck:function(){var b=p.t;b[5]=+new Date;MI.Speed(p.site,0.1,b[1]-b[0],b[5]-b[0],b[2]-b[0],b[3]-b[0],b[4]-b[0])}},w=3;6>w;w++)p["timePoint"+w]=function(b){return function(){return function(){p.t[b-1]=+new Date}}}(w);var e={data:{"0":{grpName:"默认",wGrpType:2},1E3:{grpName:"特别收听",wGrpType:2},1001:{grpName:"互听",wGrpType:2},1002:{grpName:"QQ好友",wGrpType:2},1003:{grpName:"我的微圈",wGrpType:2},1004:{grpName:"其他微圈",wGrpType:2},1005:{grpName:"微圈五的名字特别特别特别长"},1006:{grpName:"微圈陆陆陆"},1007:{grpName:"微圈sv"},1008:{grpName:"微圈8"},1009:{grpName:"微圈9"},1010:{grpName:"微圈10de名字也长的有点离谱"}},sort:[1E3,1001,1002,1003,1004],newCount_showtip:0,newCount_data:{},users:[],users_req_count:null,rear:null};try{MI.QuanData&&(e.data=MI.QuanData.tabData.data,e.sort=MI.QuanData.tabData.sort)}catch(D){}var h=0,v=UI.G("tab_quanzi"),C=0;c.events_hub=new EventsDispacther;c.events_hub.listen_obj({c_tabs:function(){},c_friends:function(){},c_click_avatar:function(){},c_click_username:function(){},c_click_avatar_recommend:function(){},c_manage_drop:function(){},c_manage_cc:function(){},c_top_tab:function(b){UI.q(v,"li").removeClass("select");h=b=UI.A(b.target,"ccid");c.doit("quan_Account_top",{cId:b});MI.TalkListTab&&MI.TalkListTab.unSelect();location.hash="!/quan/"+h},c_create_cc:function(){c.create_quan()},c_show_cc:function(b){c.quanAjax.abort();b=UI.A(b.target,"ccid");c.select_tab(b);4004==b&&MI.app({"r/qqFriendSelector":function(){MI.QQFriendSelector.qqTab()}});p.topSpan("t_index_quan")},c_add_user:function(){C++;c.add_user()},c_select_recommend:function(b){b=UI.A(b.target,"account");b=UI.G("circle_firend_rec_item_"+b);UI.hasClass(b,"selected")?UI.removeClass(b,"selected"):UI.addClass(b,"selected");var a=0;UI.each(UI.GC(UI.G("recommend_mrc"),".item_group .item"),function(b){UI.hasClass(b,"selected")&&a++});UI.G("recommend_mrc_sel_count").innerHTML=a},c_ignore_recommend:function(){d();MI.feedBack({name:"fn_close_recommend",id:j.get_id(),iPos:100})},c_close_recommend:function(){d();MI.feedBack({name:"fn_close_recommend",id:j.get_id(),iPos:100})},c_join_recommend_quan:function(){g();MI.feedBack({name:"fn_join_recommend_quan",id:j.get_id(),iPos:100})},c_join_recommend_quan_ok:function(){g();MI.feedBack({name:"fn_join_recommend_quan",id:j.get_id(),iPos:100})},c_del_user:function(b){var a=UI.A(b.target,"account");setTimeout(function(){c.del_user(h,a,function(){0==e.sort.length&&location.reload()})},100)},c_fold:function(){var b=UI.GC(UI.G("m_relation_circle"),".m_btn_fold")[0];l(b);k()},c_fold_recommend:function(){UI.hasClass(UI.G("recommend_mrc"),"hidden_state")?(UI.removeClass(UI.G("recommend_mrc"),"hidden_state"),UI.G("recommend_mrc_close").innerHTML='<a href="javascript:void(0)" e="c_close_recommend" class="close_mrc" title="关闭推荐"></a>'):(UI.addClass(UI.G("recommend_mrc"),"hidden_state"),UI.G("recommend_mrc_close").innerHTML='<a href="javascript:void(0)" e="c_join_recommend_quan">添加到微圈</a> <span class="c_tx5">|</span> <a e="c_ignore_recommend" href="javascript:void(0)">忽略</a>')},c_edit_ccname:function(){c.edit_name()},c_del_cc:function(){location.href="http://quan.t.qq.com/quan_set.php?cId="+h},c_sort_cc:function(){c.quanSort?c.quanSort.show({data:e}):setTimeout(function(){seajs.use("quan/quanSort",function(){c.quanSort=new MI.quanSort({data:e,bossId:j.get_id(),iPos:j.get_scene()+14})})},10)},rear:null});c.get_selected_ccid=function(){return h};c.get_data_ccid=function(b){b=b||h;return e.data[b]||{}};c.get_index_ccid=function(b){var a=-1,b=b||h;UI.each(e.sort,function(c,e){c==b&&(a=e)});return a};c.select_tab=function(b){h=b;trace&&trace("c_show_cc: "+b);UI.q(v,"li").removeClass("select");UI.q("#tab_quan_"+b).addClass("select");MI.TalkListTab&&MI.TalkListTab.unSelect();UI.hide("m_relation_circle");UI.hide("recommend_mrc");e.newCount_data[h]=0;UI.remove(UI.G("talkNew_quan"));n(e||{});h&&(e.users_req_count=20,c.doit("quan_Relation_groupMember",{count:e.users_req_count},function(){}),m());MI.QuanData&&MI.QuanData.firstInQQTab?setTimeout(function(){try{UI.remove(UI.G("m_relation_new_msg_setting"));UI.before(UI.html('<div id="m_relation_new_msg_setting" class="tl_margin c_tx5 clear"><div class="left">这里是你的QQ好友精彩微博聚合！不想在QQ上收到QQ好友微博更新提醒？<a target="_blank" onmousedown="MI.feedBack({name: \'c_msg_click\',id: 1744,iPos: 100});" href="http://p.t.qq.com/setting/view#qqFrdsNotice">去设置<span class="ffsong">&gt;&gt;</span></a></div></div>')[0],UI.G("m_relation_circle_wrapper"));MI.QuanData=MI.QuanData||{};MI.QuanData.firstInQQTab=null}catch(a){}MI.feedBack({name:"c_msg_expose",id:1744,iPos:100})},300):UI.remove(UI.G("m_relation_new_msg_setting"));(b=4004)&&c.doit("quan_Message_qqFriendClear");location.hash="!/quan/"+h};c.cancel=function(){};c.quanAjax={data:[]};c.quanAjax.push=function(b){c.quanAjax.data.push(b)};c.quanAjax.abort=function(){try{for(var b,a=0,f=c.quanAjax.data.length;a<f;a++)(b=c.quanAjax.data[a])&&b.abort&&b.abort(),b=null;c.quanAjax.data=[]}catch(e){}};c.doit=function(b,a,f){c.doit_action=b;a=a||{};a.r=MI.random();var d=a.cId||h||0;if(null!=b&&(0!=d&&-1!=d&&(a.cId=d,a.circleType=a.circleType||e.data[h]&&e.data[h].wGrpType||2),!("quan_Relation_recommend"==b&&null==a.cId)))a.filter=MI.microCircle_filter?MI.microCircle_filter:1,MI.versionSet({"quan/quan.xhr":"130730"}),MI.app({"quan/quan.xhr":function(){var e=MI.quan_xhr.get_domain(b),e=MI.ajax({url:e+"/e/"+(b||"quan_Account_get"),data:a,type:"post",success:function(a){a=UI.json(a);UI.each(a,function(a){UI.each(a,function(a,b){c.events_hub.exec(b,[a]);var f={name:b,id:j.get_id(),iPos:j.get_scene(),iBak2:d};MI.feedBack(f)})});f&&f(a)}});b!="quan_Account_get"&&c.quanAjax.push(e)}})};c.edit_name=function(b,a){UI.q(".textarea_btn_pn").remove();MI.dialog_edit_ccname=new MI.Dialog;h=b||h;var f=!0;MI.dialog_edit_ccname.show({title:'<h1 class="DmainTit">修改微圈名</h1>',html:'<div id="win_edit_ccname" class="textarea_btn_pn">\t<div class="textarea_pn"><input id="win_edit_ccname_txt" type="text" onkeyup="MI.dialog_edit_ccname.validate()" onkeydown="MI.dialog_edit_ccname.validate()" value="'+e.data[h].grpName+'" class="">\t</div>\t<div class="btn_pn clear"><div class="right">\t<span id="win_edit_ccname_tip" class="fs12 c_tx4"></span>\t<a href="javascript:void(0)" onclick="MI.dialog_edit_ccname.save_and_exit()" class="gb_btn gb_btn1"><span class="t">确定</span></a>\t<a href="javascript:void(0)" onclick="MI.dialog_edit_ccname.exit()" class="gb_btn gb_btn5"><span class="t">取消</span></a></div>\t</div></div>'});MI.dialog_edit_ccname.validate=function(){return f=z.check_name(UI.G("win_edit_ccname_txt"),UI.G("win_edit_ccname_tip"))};MI.dialog_edit_ccname.save_and_exit=function(){MI.dialog_edit_ccname.validate();f&&setTimeout(function(){c.doit("quan_Account_edit",{cId:h,circleName:UI.G("win_edit_ccname_txt").value},function(){location.hash="!/quan/"+h;a&&a()});MI.dialog_edit_ccname.hide()},100)};MI.dialog_edit_ccname.exit=function(){f=!0;MI.dialog_edit_ccname.hide()}};c.del_cc=function(b,a){h=b||h;MI.confirm({title:_("确定要删除微圈("+String(e.data[h].grpName)+")？"),content:_("删除后该微圈下已收听的人不会被取消收听。"),confirm:function(){MI.confirm.hide();MI.dialog.hide();var b=h,b=e.sort[0]==h?e.sort[1]||0:e.sort[0]||0;MI.feedBack({name:"c_before_del_cc",id:1744,iPos:100});c.doit("quan_Account_delete",null,function(){MI.feedBack({name:"c_after_del_cc",id:1744,iPos:100});0==e.sort.length&&(location.hash="",location.reload());a&&a()});h=b;location.hash="!/quan/"+h}})};c.add_user=function(b,a){c.is_create_quan=!1;h=b||h;MI.dlg_addAbleUser=new MI.CircleMemberSelector;MI.dlg_addAbleUser.start=0;MI.dlg_addAbleUser.on_cancel=function(){MI.feedBack({name:"c_dlg_add_user_cancel",id:j.get_id(),iPos:j.get_scene("c_dlg_add_user")})};MI.dlg_addAbleUser.on_ok=function(f){c.doit("quan_Relation_addUser",{accounts:f.join(",")},function(){MI.tip("添加成员成功");a&&a()});MI.dlg_addAbleUser.close_dlg();MI.feedBack({name:"c_dlg_add_user_ok",id:j.get_id(),iPos:j.get_scene("c_dlg_add_user"),iBak2:b,sBak2:f.join()});location.hash="!/quan/"+h};MI.dlg_addAbleUser.create({title:"添加成员",on_select:function(a){UI.A(a,"account")&&MI.feedBack({name:"c_dlg_add_user_selected_user",id:j.get_id(),iPos:j.get_scene("c_dlg_add_user"),iBak2:h,sBak2:UI.A(a,"account")})},on_tabs:function(a){MI.feedBack({name:"c_dlg_add_user_tabs_"+a,id:j.get_id(),iPos:j.get_scene("c_dlg_add_user"),iBak2:h})},on_search:function(a){MI.feedBack({name:"c_dlg_add_user_search_keyword",id:j.get_id(),iPos:j.get_scene("c_dlg_add_user"),sBak2:a});MI.feedBack({name:"c_dlg_add_user_search_expose",id:j.get_id(),iPos:j.get_scene("c_dlg_add_user"),sBak2:String(MI.dlg_addAbleUser.memberItemSelect.get_accounts())})},on_create:function(){setTimeout(function(){MI.feedBack({name:"c_dlg_add_user_expose",id:j.get_id(),iPos:j.get_scene("c_dlg_add_user"),sBak2:String(MI.dlg_addAbleUser.memberItemSelect.get_accounts())})},2E3)}})};c.del_user_confirm=function(b,a,f){var e="object"==typeof b?b:{};e.account=e.account||a;e.ccid=e.ccid||h;e.callback=e.callback||f;MI.confirm({title:"您确定要把"+String(e.name||"选中的用户")+"移出微圈？",content:'<div id="talkListShieldUser">移出后，TA的广播将不会在该微圈中出现。（不会取消收听）</div>',confirm:function(){c.del_user(e.ccid,e.account,function(){MI.confirm.hide();MI.tip(_("移出成功"));e.callback&&e.callback()})}})};c.del_user=function(b,a,f){h=b||h;if(1>=e.users.length&&4002==h)c.doit("quan_Relation_deleteUser",{accounts:a}),setTimeout(function(){f&&f();location.hash="";location.reload()},500);else{if(1>=e.users.length)return MI.confirm({title:_("确定要删除最后一个成员？"),content:_("删除后同时会将该微圈删除。"),confirm:function(){var a=h,a=e.sort[0]==h?e.sort[1]||0:e.sort[0]||0;c.doit("quan_Account_delete",null,function(){f&&f()});h=a;location.hash="!/quan/"+a;MI.confirm.hide();MI.dialog.hide()}}),!1;c.doit("quan_Relation_deleteUser",{accounts:a},function(){m();f&&f()});for(var b=null,d=0,g=e.users.length;d<g;d++)if(e.users[d].name==a){b=d;break}null!=b&&(UI.remove(UI.G("circle_firend_item_"+a)),e.users.splice(b,1));k()}};c.create_quan=function(b){if(e.sort&&23<=e.sort.length)MI.tip("微圈已达上限，无法创建，请删除一些微圈后再试");else{c.is_create_quan=!0;var a=!1,f=function(){return a=z.check_name(UI.G("win_create_ccname_txt"),UI.G("win_create_ccname_tip"))};MI.dlg_addAbleUser=new MI.CircleMemberSelector;MI.dlg_addAbleUser.start=0;MI.dlg_addAbleUser.on_cancel=function(){MI.feedBack({name:"c_dlg_create_cc_cancel",id:j.get_id(),iPos:j.get_scene("c_dlg_create_cc")})};MI.dlg_addAbleUser.on_ok=function(e){f();!0==a&&(UI.q(v,"li").removeClass("select"),UI.G("win_create_ccname_tip").innerHTML="",MI.dlg_addAbleUser.v=e||[],c.doit("quan_Account_create",{circleName:UI.G("win_create_ccname_txt").value,cId:-1},function(){b&&b()}),MI.feedBack({name:"c_dlg_create_cc_ok",id:j.get_id(),iPos:j.get_scene("c_dlg_create_cc"),sBak2:e.join()}))};MI.dlg_addAbleUser.create({title:"创建",on_select:function(a){UI.A(a,"account")&&MI.feedBack({name:"c_dlg_create_cc_selected_user",id:j.get_id(),iPos:j.get_scene("c_dlg_create_cc"),sBak2:UI.A(a,"account")})},on_tabs:function(a){MI.feedBack({name:"c_dlg_create_cc_tabs_"+a,id:j.get_id(),iPos:j.get_scene("c_dlg_create_cc"),iBak2:h})},on_search:function(a){MI.feedBack({name:"c_dlg_create_cc_search_keyword",id:j.get_id(),iPos:j.get_scene("c_dlg_create_cc"),sBak2:a});MI.feedBack({name:"c_dlg_create_cc_search_expose",id:j.get_id(),iPos:j.get_scene("c_dlg_create_cc"),sBak2:String(MI.dlg_addAbleUser.memberItemSelect.get_accounts())})},on_create:function(){UI.GC(MI.dlg_addAbleUser.alert._wrap,".pop_chs_top_textbox")[0].innerHTML='<div class="mrc_name"><span class="fs14">微圈名称：</span><input id="win_create_ccname_txt" type="text" class="text"><span id="win_create_ccname_tip" class="c_tx4"></span></div>';UI.EA(UI.G("win_create_ccname_txt"),"keyup",function(){f()});UI.EA(UI.G("win_create_ccname_txt"),"change",function(){f()});try{var a=function(){UI.G("win_create_ccname_txt").focus()};setTimeout(a,200);setTimeout(a,400);setTimeout(a,600)}catch(b){}setTimeout(function(){MI.feedBack({name:"c_dlg_create_cc_expose",id:j.get_id(),iPos:j.get_scene("c_dlg_create_cc"),sBak2:String(MI.dlg_addAbleUser.memberItemSelect.get_accounts())})},2E3)}})}};c.load_addAbleUser=function(b){var a=!1,f={};f.start=MI.dlg_addAbleUser.start;f.count=45;"create"==b&&(f.cId=-1);c.doit("quan_Relation_addAbleUser",f,function(){if(MI.dlg_addAbleUser.start==0){var b=UI.G("quan_qqfriend_listview");b.onscroll=function(){if(a!=true&&parseInt(UI.height(UI.GC(b,"ul")[0]))-parseInt(b.scrollTop)<400){MI.dlg_addAbleUser.start=MI.dlg_addAbleUser.start+f.count+1;f.start=MI.dlg_addAbleUser.start;a=true;c.doit("quan_Relation_addAbleUser",f,function(){a=false})}}}})};c.create=function(){UI.EA(UI.parent(UI.parent(v)),"click",function(a){var a=UI.E(a),b=(UI.A(a.target,"e")||"").split(","),e;for(e in b){var d=b[e];if(d&&c.events_hub[d]){c.events_hub.dispatch(d,[a]);var g=Number(UI.A(a.target,"boss_scene")),d={name:d,id:j.get_id(),iPos:g?j.get_scene()+g:j.get_scene(d),iBak1:1,iBak2:UI.A(a.target,"ccid")||h,sBak2:UI.A(a.target,"account")||""};MI.feedBack(d)}}});c.events_hub.listen("on_dispatch",function(a,b){e[a]=b});c.events_hub.listen("Quan_Account_list",function(a){e.data=a.data||{};e.sort=a.sort||[];e.other=a.other||null;if("pkuleon"==MI.user.account)for(var b in e.data)UI.isUndefined(e.data[b].firstFlag)||(e.data[b].firstFlag=0);UI.removeClass(UI.G("home_all_top"),"select");UI.show(UI.G("m_relation_circle"));UI.remove(UI.G("talkNew_quan"));trace&&trace(e);MI.newCount?setTimeout(function(){MI.app("NewMsgBox",function(){try{var a=[],a=(e.sort||[]).join().split(",");a.unshift(h);MI.newCount.data.cid=a.join();if(!c._newCount_init){String(MI.newCount.type).match("103")||(MI.newCount.type+=",103");var b=0;UI.linkEvent.add("newCountShow",function(a){if(a.type==103){e.newCount_data={};var a=a.num||a.value,c;for(c in a)a[c]>0&&(e.newCount_data[c]=a[c]);e.newCount_data[h]>0&&!UI.G("talkNew_quan")&&setTimeout(function(){try{UI.remove(UI.G("talkNew_quan"));UI.after(UI.html('<div class="newsBox2" id="talkNew_quan" load="1" style="display: block; opacity: 1;"><a href="javascript:void(0)" tabindex="4" accesskey="q">有新广播，点击查看</a></div>')[0],UI.G("m_relation_circle_wrapper"));var a=function(){UI.ER(UI.G("talkNew_quan"),"click",a);UI.remove(UI.G("talkNew_quan"));m()};UI.EA(UI.G("talkNew_quan"),"click",a)}catch(b){}},1E3);b==0&&n(e);b++;b>=6&&(b=0)}});MI.newCount.refresh();c._newCount_init=!0}}catch(d){}})},500):MI.feedBack({name:"err_newCount",id:j.get_id(),iPos:j.get_scene()});b=String(location.hash);if(b.match("!/list/qqfriends/"))location.hash="",c.select_tab(4004),MI.feedBack({name:"c_hash_qqfriends",id:j.get_id(),iPos:j.get_scene(),sBak2:"!/list/qqfriends/"}),___fixeIEhash();else{var d=UI.parseUrl();if(d.pgv_ref||d.pref)MI.feedBack({name:"c_hash_qqfriends",id:j.get_id(),iPos:j.get_scene(),sBak1:d.pgv_ref||d.pref,sBak2:location.href});a.newCid&&(h=a.newCid,location.hash="!/quan/"+h);a.delCid&&0<e.sort.length&&(h=e.sort[0],location.hash="!/quan/"+h);if(b.match("!/quan/")){b=Number(String(b.split("/").pop()));if(e.data[b]){c.select_tab(b);return}location.hash=""}n(e);0==h&&UI.addClass(UI.G("home_all_top"),"select");h&&(c.doit("quan_Relation_groupMember"),m());a.newCid&&c.doit("quan_Relation_addUser",{accounts:MI.dlg_addAbleUser.v.join(",")},function(){MI.tip("创建成功");MI.dlg_addAbleUser.close_dlg();c._on_create_quan&&c._on_create_quan(a.newCid)});setTimeout(function(){___fixeIEhash()},1E3)}});c.events_hub.listen("quan_Relation_member",function(a){e.users=a.users||[];e.users_count=a.users_count||0;e.users_fold=null==a.fold||!0==a.fold?!0:!1;UI.show("m_relation_circle");UI.hide("recommend_mrc");q(e);p.timePoint3()()});c.events_hub.listen("quan_Relation_needRecommend",function(a){a&&c.doit("quan_Relation_recommend",null,function(){})});c.events_hub.listen("quan_Account_getList",function(a){a&&(e.other=a,n(e))});c.events_hub.listen("quan_Relation_recommend",function(a){if(a.users&&a.users.length){UI.hide("m_relation_circle");UI.show("recommend_mrc");null==UI.G("m_relation_circle_wrapper")&&MI.TalkListTab.showCont('<div id="m_relation_circle_wrapper"></div>');null==UI.G("recommend_mrc")?(MI.TalkListTab.showCont(),UI.G("m_relation_circle_wrapper").appendChild(UI.html('<div id="recommend_mrc" class="m_relation_circle recommend_mrc hidden_state" style="display:block">\t<div e="c_fold_recommend" class="mrc_hd clear" id="recommend_mrc_hd"><div class="mrc_arr clear" style="display:none">\t<div class="arr_out"></div>\t<div class="arr_in"></div></div><div class="left">\t<div id="recommend_mrc_tips" e="c_fold_recommend" class="ex_3 c_tx5">推荐你收听的{0}位用户</div>\t<div class="ex_2 c_tx5"><div id="recommend_mrc_tiny_icons" class="pic"></div><div e="c_fold_recommend" class="more_mrc">\t<div e="c_fold_recommend" class="pic"></div>\t<span e="c_fold_recommend" class="click">查看</span></div>\t</div></div><div class="right" id="recommend_mrc_close" ><a href="javascript:void(0)" e="c_join_recommend_quan">添加到微圈</a> <span class="c_tx5">|</span> <a e="c_ignore_recommend" href="javascript:void(0)">忽略</a></div>\t</div>\t<div class="mrc_bd"><div class="scrollbar" style="overflow-x:hidden;overflow-y:auto;">\t<div class="item_group clear" id="recommend_mrc_item_group"></div></div>\t</div>\t<div class="mrc_fd clear"><div class="tac">\t<span class="c_tx5">已选<span id="recommend_mrc_sel_count">0</span>人</span>\t<a href="javascript:void(0)" e="c_join_recommend_quan_ok" class="gb_btn gb_btn1"><span e="c_join_recommend_quan_ok" class="t">加入该微圈</span></a></div>\t</div></div>')[0])):MI.TalkListTab.showCont();UI.hasClass(UI.G("recommend_mrc"),"hidden_state")||UI.addClass(UI.G("recommend_mrc"),"hidden_state");for(var b="",c="",e=[],d=0,g=a.users.length;d<g;d++){var i=a.users[d];i.avatar_100=i.avatar?i.avatar+"/100":"http://qzonestyle.gtimg.cn/ac/qzone_v5/avatar/100/5001.jpg";i.avatar_50=i.avatar?i.avatar+"/50":"http://qzonestyle.gtimg.cn/ac/qzone_v5/avatar/50/5001.jpg";b=b+'<div id="circle_firend_rec_item_'+i.name+'" class="item selected">\t<div class="selected_this"><a href="javascript:void(0)"></a></div>\t<div class="inner" uin="'+i.uin+'" ><a account="'+i.name+'" e="c_select_recommend" href="javascript:void(0)"><img account="'+i.name+'" e="c_select_recommend" src="'+i.avatar_50+'" alt="" class="user_pic" /></a><div class="user_name"><a target="_blank" href="http://t.qq.com/'+i.name+'" title="'+i.nick+'">'+MI.string.html(MI.string.cut(i.nick,10,".."))+"</a></div>\t</div></div>";9>d&&(c+='<a target="_blank" title="'+i.nick+'" href="http://t.qq.com/'+i.name+'"><img src="'+i.avatar_50+'" alt=""></a>');e.push(i.name)}6>=a.users.length?UI.q(UI.G("recommend_mrc"),".more_mrc .pic").hide():UI.q(UI.G("recommend_mrc"),".more_mrc .pic").show();UI.G("recommend_mrc_item_group")&&(UI.G("recommend_mrc_item_group").innerHTML=b);UI.G("recommend_mrc_tiny_icons")&&(UI.G("recommend_mrc_tiny_icons").innerHTML=c);UI.G("recommend_mrc_tips").innerHTML=_(s._recommend_tips_0,a.users.length);UI.G("recommend_mrc_sel_count").innerHTML=a.users.length||0;MI.feedBack({name:"c_recommend_expose",id:j.get_id(),iPos:j.get_scene()+4,iBak2:h,sBak2:e.join()});MI.feedBack({name:"c_recommend_layer_expose",id:j.get_id(),iPos:j.get_scene()+4})}});c.events_hub.listen("Quan_Relation_addAbleUser",function(a){MI.dlg_addAbleUser&&(0==MI.dlg_addAbleUser.start?MI.dlg_addAbleUser.show(a.users):0<MI.dlg_addAbleUser.start&&MI.dlg_addAbleUser.add_data(a.users),!0==a.is_end&&(UI.remove(UI.G("Quan_Relation_addAbleUser_loading")),UI.G("quan_qqfriend_listview").onscroll=null))});c.events_hub.listen("quan_Relation_deleteUser",function(a){UI.each(a.users||[],function(a){UI.remove(UI.G("tiny_icon_"+a.name))});e.users_count-=parseInt(a.users.length);k()});c.events_hub.listen("quan_Relation_addUser",function(a){c.is_create_quan&&(e.users=[]);UI.each(a.users||[],function(a){e.users.unshift(a)});e.users_count+=parseInt(a.users.length);q(e);m()});c.events_hub.listen("quan_Relation_recommendFeedback",function(a){c.is_create_quan&&(e.users=[]);UI.each(a.users||[],function(a){e.users.unshift(a)});e.users_count+=parseInt(a.users.length);q(e);m()});c.events_hub.listen("Err_Exception",function(a){console&&console.log("Err_Exception",a)});c.events_hub.listen("LOG_FRONT",function(a){console&&console.log("LOG_FRONT:",a)});c.events_hub.listen("ERR_FRONT",function(a){console&&console.log("ERR_FRONT:",a)});c.events_hub.listen("ERR_INNER",function(a){console&&console.log("ERR_FRONT:",a)});c.events_hub.listen("Alert",function(a){MI.alert(a,MI._alert_close)});c.events_hub.listen("Tip",function(a){MI.tip(a)});var b=!1;UI.linkEvent.add("talkListTabShow",function(a){try{if("all"==a.id)!0==b&&(h=0,location.hash="!/home",$$(".unit .more a .text")[0].innerHTML="更多微圈",c.quanAjax&&c.quanAjax.abort(),UI.A(UI.G("talkNew"),"style","display:none"));else if(("weixun"==a.id||"worldcup"==a.id)&&!0==b)h=0,c.quanAjax&&c.quanAjax.abort(),UI.A(UI.G("talkNew"),"style","display:none")}catch(d){}b=!0});UI.linkEvent.add("talkListTabLoad",function(a){"quan"==a.id&&(p.timePoint4()(),p.endCheck())})};return c};MI.microCircle.create();MI.microCircle_callback&&MI.microCircle_callback();if(UI.B.ie)try{setInterval(function(){___fixeIEhash()},500)}catch(k){}})})}catch(k){trace&&trace(k.stack)}})});/*version:149034*//*  |xGv00|ab95c7d428b3f57da0ebdaed8c9e046c */